---
title: "ggplot practice"
author: "Krutal Patel"
date: "1/11/2022"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

To run each chunk, click on the green arrow button in each code block.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. 

## Set up for Data Visualization

Uncomment and run chunk to install the package ggplot2. Recomment out this section before knitting the document
```{r}
#install.packages("ggplot2", dependencies = TRUE)
```

Open ggplot2 library
```{r}
library(ggplot2)
```

## Plotting Example

The dataset `mpg` has data on several car models collected the US EPA. The code chunk below generates a plot that displays some of that data.

```{r}
ggplot(data = mpg) +
  geom_point(mapping = aes(x = cty, y = hwy, color = class, shape = drv))
```

### Description of the Data Visualization Example
The geometric primitive chosen to encode each car is a point. A visualization with points (i.e a scatterplot) is generated by selecting `geom_point`.

The visualization uses three visual channels: position (on x- and y- axes), hue, and shape. These visual channels are incorporated into the visualization by specifying aesthetic mappings in the ggplot function.

The position on the x-axis encodes a car’s fuel efficiency in the city in miles per gallon (mpg).  These values are recorded in the dataset under the variable titled `cty`. The position on the y-axis encodes a car’s fuel efficiency on the highway in mpg from the variable `hwy`.

Hues are used to encode the class of cars such as compact, midsize, and SUV. The `class` variable is added to the plot by mapping the levels of `color` to the values of `class`.

Shapes are utilized to encode the type of drive including four wheel drive, front-wheel drive, and rear wheel drive. The `drv` variable is added to the plot by mapping the levels of `shape` to the values of `drv`.

## Code Template. If desired use for prompts below, replace the bracketed sections and delete the `#`'s
```{r}
# ggplot(data = <DATA>) + 
#  <GEOM_FUNCTION>(mapping = aes(<MAPPINGS>))
```

## Visualizing Data from Experiments on Cyanobacteria Growth

In 2020, the Baltimore Biocrew, a team of high school student researchers, was interested in engineering a strain of cyanobacteria to be more tolerant in iron-poor environment. First, they set out to show that iron is a limiting nutrient for cyanobacteria. They tested this by tracking the growth of a specific strain of cyanobacteria (Synechococcus CB0101) in tubes with various iron concentrations relative to that found in standard growth media (0x, 1/100x, 1/10x, 1x, 10x). Four students each conducted an independent trial by measuring turbidity of each culture tube using Secchi sticks over many days. Later, these measurement were converted into optical density (OD).  

1. Load in `growth` data from the students' experiment
```{r}
growth <- read.csv('https://raw.githubusercontent.com/kpclifton/intersession_data_2023/main/code/day4/cyanobacteria_growth.csv')
```

2. View how the data is structured by printing the first 10 rows.
```{r}
head(growth, 10)
```

3. View a summary of the data to understand basic statistics about the values in the columns (such as counts for categorical variables and means for continous variables).
```{r}
summary(growth)
```

Optional: The `View` function opens the dataframe in another tab where you can scroll through the whole dataset. Recomment out this section before knitting the document
```{r}
#View(growth)
```


4. Plot `Hours` vs `OD` as smooth line using `geom_smooth`
```{r}

ggplot(data = growth, aes(x=ï..Hours, y=OD)) + geom_smooth() + ggtitle('Hours vs OD of Growth Data')

```

5. Plot `Hours` vs `OD` as scatter plot using `geom_point`
```{r}

ggplot(data = growth, aes(x=ï..Hours, y=OD)) + geom_point() + ggtitle('Hours vs OD of Growth Data')

```


6. Plot `Hours` vs `OD` as scatter plot and encode trial as the visual channel hue by mapping `color` to the variable `Trial`
```{r}
ggplot(data = growth, aes(x=ï..Hours, y=OD, color = Trial)) + geom_point() + ggtitle('Hours vs OD of Growth Data by Trial Number')

```
```{r}
head(growth)
```

7. Try to create new exploratory visualization(s) of your own design. Write a description of which geometric primitive and visual channels you chose to use. Consider what you think would be useful given the purpose of the experiment or simply test out different different functions and settings. You can use the ggplot cheat sheet.

```{r}
# Study hours vs OD but now group by Iron concentrations to visualize any differences or correlations
# For this I will use color to denote each iron type

ggplot(data = growth, aes(x=ï..Hours, y=OD, color = Iron)) + geom_point() + ggtitle('Hours vs OD of Growth Data by Iron Concentration')


```

```{r}

# Create a bar graph showing several metrics OD by each trial
# This becomes a categorical data visualization where we are comparing results accross each independent trial. 

# first step is to use group-by methods 
             
data_summary1 <- do.call(data.frame,    # Calculate summary stats using aggregate
                         aggregate(OD ~ Trial,
                                   growth,
                                   FUN = function(x) c(mean(x), min(x), max(x), median(x), sd(x) ) ))

colnames(data_summary1) <- c("Trial", "mean", "min", "max", "median", "stdev")

# use a bar graph to visualize the mean and associated standard deviation for each trial 

ggplot(data_summary1) +
    geom_bar( aes(x=Trial, y=mean), stat="identity", fill="skyblue", alpha=0.7) +
    geom_errorbar( aes(x=Trial, ymin=mean-stdev, ymax=mean+stdev), width=0.4, colour="black", alpha=0.9, size=1.3) + ggtitle('Mean OD with Stdev of OD for each Trial')

ggplot(data_summary1) +
    geom_bar( aes(x=Trial, y=median), stat="identity", fill="skyblue", alpha=0.7) +
    geom_errorbar( aes(x=Trial, ymin=min, ymax=max), width=0.4, colour="black", alpha=0.9, size=1.3) + ggtitle('Median OD with Range of OD for each Trial')


```

```{r}

# 
             
data_summary2 <- do.call(data.frame,    # Calculate summary stats using aggregate
                         aggregate(OD ~ Iron,
                                   growth,
                                   FUN = function(x) c(mean(x), min(x), max(x), median(x), sd(x) ) ))

colnames(data_summary2) <- c("Iron", "mean", "min", "max", "median", "stdev")

# use a bar graph to visualize the mean and associated standard deviation for each trial 

ggplot(data_summary2) +
    geom_bar( aes(x=Iron, y=mean), stat="identity", fill="burlywood", alpha=0.7) +
    geom_errorbar( aes(x=Iron, ymin=mean-stdev, ymax=mean+stdev), width=0.4, colour="black", alpha=0.9, size=1.3) + ggtitle('Mean OD with Stdev of OD for each Iron Concentration')


ggplot(data_summary2) +
    geom_bar( aes(x=Iron, y=median), stat="identity", fill="burlywood", alpha=0.7) +
    geom_errorbar( aes(x=Iron, ymin=min, ymax=max), width=0.4, colour="black", alpha=0.9, size=1.3) + ggtitle('Median OD with Range of OD for each Iron Concentration')

```

```{r}

# Plot regression lines for Hours VS OD for each respective trial. Here, we use the geom_smooth method and apply color encodings to represent each respective trial. Used color to highlight each individual line.

ggplot(data = growth, aes(x=ï..Hours, y=OD, color = Trial)) + geom_smooth(method = 'lm', fill = NA) + ggtitle('Hours vs OD of Growth Data by Trial Number')

# Plot regression lines for Hours VS OD for each respective Iron concentration. Here, we use the geom_smooth method and apply color encodings to represent each respective iron concentration. Used color to highlight each individual line.

ggplot(data = growth, aes(x=ï..Hours, y=OD, color = Iron)) + geom_smooth(method = 'lm', fill = NA) + ggtitle('Hours vs OD of Growth Data by Iron Concentration')  

```

